#! /usr/bin/env python3

#
# Created by Gustavo Viegas on 2017/06
#

import random

coords = [
    (51.650860, -0.186010), (51.651066, -0.185838), (51.651186, -0.185613),
    (51.651286, -0.185441), (51.651326, -0.185291), (51.651253, -0.185162),
    (51.651146, -0.185076), (51.651053, -0.184969), (51.650966, -0.184872),
    (51.650886, -0.184818), (51.650786, -0.184646), (51.650666, -0.184571),
    (51.650593, -0.184442), (51.650460, -0.184367), (51.650340, -0.184238),
    (51.650147, -0.184002), (51.650054, -0.183905), (51.650374, -0.183787),
    (51.650361, -0.183669), (51.650681, -0.186340), (51.650661, -0.186555),
    (51.650834, -0.186759), (51.651020, -0.186888), (51.651067, -0.187038),
    (51.651260, -0.187199), (51.651460, -0.187371), (51.651563, -0.187253),
    (51.651620, -0.187135), (51.651727, -0.187017), (51.651800, -0.186904),
    (51.651926, -0.186748), (51.652112, -0.186571), (51.652222, -0.186437),
    (51.652272, -0.186314), (51.652245, -0.186223), (51.652188, -0.186175),
    (51.652141, -0.186132), (51.652078, -0.186011), (51.651975, -0.185963),
    (51.651898, -0.185856), (51.651778, -0.185754), (51.651665, -0.185620),
    (51.651642, -0.185566), (51.651532, -0.185475), (51.651462, -0.185362),
    (51.651419, -0.185228), (51.651452, -0.185131), (51.651549, -0.185024),
    (51.650491, -0.186338), (51.650414, -0.186279), (51.650381, -0.186182),
    (51.650312, -0.186123), (51.650522, -0.186574), (51.650489, -0.186579),
    (51.650474, -0.186665), (51.650394, -0.186719), (51.651392, -0.187556),
    (51.651392, -0.187642), (51.651379, -0.187739), (51.651239, -0.187900),
    (51.651565, -0.187589), (51.651705, -0.187664), (51.652424, -0.186291)
]

unit = """
  da.collections.units.insert({{
    id: '{id}',
    location: {{type: 'Point', coordinates: [{coord}]}},
    data: [{data}]
  }});
  da.collections.vdata.insert({{
    id: '{id}',
    location: {{type: 'Point', coordinates: [{coord}]}},
    data: [{data}]
  }});
"""

data = """
      {{time: \'2017-1-1\', value: {0}}},
      {{time: \'2017-1-2\', value: {1}}},
      {{time: \'2017-1-3\', value: {2}}}
    """

def vrand(n):
    v = []
    for i in range(n):
        v.append(random.uniform(0.1, 9.9))
    return v

s = ''
for i in range(len(coords)):
    v1, v2, v3 = vrand(3)
    u = unit.format(
        id='u{0}@units'.format(str(i+1)),
        coord='{0}, {1}'.format(coords[i][1], coords[i][0]),
        data=data.format(v1, v2, v3))
    s += u

sf = """
function testData(da) {{
{0}
}}
""".format(s)

with open('test/test_data.txt', 'w') as f:
    f.write(sf)
